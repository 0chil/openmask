{"remainingRequest":"C:\\Users\\Park\\Desktop\\vuejs\\mask-finder\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Park\\Desktop\\vuejs\\mask-finder\\src\\components\\Map.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Park\\Desktop\\vuejs\\mask-finder\\src\\components\\Map.vue","mtime":1583973714780},{"path":"C:\\Users\\Park\\Desktop\\vuejs\\mask-finder\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Park\\Desktop\\vuejs\\mask-finder\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Park\\Desktop\\vuejs\\mask-finder\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\Park\\Desktop\\vuejs\\mask-finder\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Park\\Desktop\\vuejs\\mask-finder\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWVEYXVtTWFwIGZyb20gJ3Z1ZS1kYXVtLW1hcCc7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTWFwJywKCiAgY29tcG9uZW50czp7CiAgICBWdWVEYXVtTWFwLAogIH0sCgogIGRhdGE6ICgpID0+ICh7CiAgICBhcHBLZXk6ICc2ZjQyODU0N2Y4ZmYyNjQwMmQyZWRlOGRhYThiMjQwYycsCiAgICBjZW50ZXI6IHtsYXQ6MzMuNDUwNzAxLCBsbmc6MTI2LjU3MDY2N30sCiAgICBsZXZlbDogNCwgCiAgICBtYXBUeXBlSWQ6IFZ1ZURhdW1NYXAuTWFwVHlwZUlkLk5PUk1BTCwgCiAgICBsaWJyYXJpZXM6IFtdLAogICAgbWFwOiBudWxsLAogICAgY2VudGVyTWFya2VyOm51bGwsCiAgICBjZW50ZXJDaXJjbGU6bnVsbCwKICAgIG1hcmtlckFycmF5OltdLAoKICAgIGxvY2F0aW9uOm51bGwsCiAgICBnZXR0aW5nTG9jYXRpb246IGZhbHNlLAogICAgZXJyb3JTdHI6bnVsbCwKICB9KSwKICBtZXRob2RzOiB7CiAgICAvLyDsp4Drj4TqsIAg66Gc65OcIOyZhOujjOuQmOuptCBsb2FkIOydtOuypO2KuCDrsJzsg50KICAgIG9uTG9hZCAobWFwKSB7CiAgICAgIHRoaXMubWFwID0gbWFwOwogICAgICBpZih0aGlzLmxvY2F0aW9uKXsKICAgICAgICB0aGlzLnNldENlbnRlcigpOwogICAgICB9CiAgICAgIHZhciByZWY9dGhpczsKICAgICAgdmFyIHN0YXJ0TGF0LHN0YXJ0TG5nLHN0YXJ0TGV2ZWw7CiAgICAgIGtha2FvLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnZHJhZ2VuZCcsIGZ1bmN0aW9uKCkgewogICAgICAgIHJlZi5nZXRTdG9yZXNCeUdlbyhtYXAuZ2V0Q2VudGVyKCkuZ2V0TGF0KCksbWFwLmdldENlbnRlcigpLmdldExuZygpKTsKICAgICAgfSk7CiAgICAgIGtha2FvLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnem9vbV9zdGFydCcsIGZ1bmN0aW9uKCkgewogICAgICAgIHN0YXJ0TGF0PW1hcC5nZXRDZW50ZXIoKS5nZXRMYXQoKTsKICAgICAgICBzdGFydExuZz1tYXAuZ2V0Q2VudGVyKCkuZ2V0TG5nKCk7CiAgICAgIH0pOwogICAgICBrYWthby5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ3pvb21fY2hhbmdlZCcsIGZ1bmN0aW9uKCkgewogICAgICAgIGlmKG1hcC5nZXRMZXZlbCgpPnN0YXJ0TGV2ZWwpCiAgICAgICAgICBtYXAuc2V0Q2VudGVyKG5ldyBrYWthby5tYXBzLkxhdExuZyhzdGFydExhdCxzdGFydExuZykpOwogICAgICAgIHJlZi5nZXRTdG9yZXNCeUdlbyhtYXAuZ2V0Q2VudGVyKCkuZ2V0TGF0KCksbWFwLmdldENlbnRlcigpLmdldExuZygpKTsKICAgICAgfSk7CiAgICB9LAogICAgc2V0Q2VudGVyOiBmdW5jdGlvbigpewogICAgICBpZih0aGlzLmNlbnRlck1hcmtlcikgdGhpcy5jZW50ZXJNYXJrZXIuc2V0TWFwKG51bGwpOwogICAgICB0aGlzLm1hcC5zZXRMZXZlbCg0KTsKICAgICAgdGhpcy5tYXAuc2V0Q2VudGVyKG5ldyBrYWthby5tYXBzLkxhdExuZyh0aGlzLmxvY2F0aW9uLmNvb3Jkcy5sYXRpdHVkZSx0aGlzLmxvY2F0aW9uLmNvb3Jkcy5sb25naXR1ZGUpKTsKICAgICAgdmFyIGltYWdlU3JjID0gcmVxdWlyZSgnQC9hc3NldHMvcGVyc29uX3Bpbl8yNHB4X3JlZC5zdmcnKSwgIAogICAgICAgICAgaW1hZ2VTaXplID0gbmV3IGtha2FvLm1hcHMuU2l6ZSgzNiwgMzYpOwogICAgICB2YXIgbWFya2VySW1hZ2UgPSBuZXcga2FrYW8ubWFwcy5NYXJrZXJJbWFnZShpbWFnZVNyYyxpbWFnZVNpemUse30pOwogICAgICB0aGlzLmNlbnRlck1hcmtlciA9IG5ldyBrYWthby5tYXBzLk1hcmtlcih7IAogICAgICAgIHBvc2l0aW9uOiB0aGlzLm1hcC5nZXRDZW50ZXIoKSwKICAgICAgICBpbWFnZTogbWFya2VySW1hZ2UKICAgICAgfSk7CiAgICAgIHRoaXMuY2VudGVyTWFya2VyLnNldE1hcCh0aGlzLm1hcCk7CiAgICAgIHRoaXMuZ2V0U3RvcmVzQnlHZW8odGhpcy5tYXAuZ2V0Q2VudGVyKCkuZ2V0TGF0KCksdGhpcy5tYXAuZ2V0Q2VudGVyKCkuZ2V0TG5nKCkpOwogICAgfSwKICAgIExldmVsMlJhbmdlOiBmdW5jdGlvbihsZXZlbCl7CiAgICAgICAgaWYobGV2ZWw8NSkKICAgICAgICAgIHJldHVybiAxNTAwOwogICAgICAgIGVsc2UgaWYobGV2ZWw8OCkKICAgICAgICAgIHJldHVybiAyNTAwOwogICAgICAgIGVsc2UgaWYobGV2ZWw8MTApCiAgICAgICAgICByZXR1cm4gMzUwMDsKICAgICAgICBlbHNlIHJldHVybiA1MDAwOwogICAgfSwKICAgIGdldFN0b3Jlc0J5R2VvOiBmdW5jdGlvbihsYXQsIGxuZyl7CiAgICAgIGlmKHRoaXMuY2VudGVyQ2lyY2xlKSB0aGlzLmNlbnRlckNpcmNsZS5zZXRNYXAobnVsbCk7CiAgICAgICAgdGhpcy5jZW50ZXJDaXJjbGUgPSBuZXcga2FrYW8ubWFwcy5DaXJjbGUoewogICAgICAgICAgbWFwOiB0aGlzLm1hcCwKICAgICAgICAgIGNlbnRlciA6IG5ldyBrYWthby5tYXBzLkxhdExuZyhsYXQsbG5nKSwgCiAgICAgICAgICByYWRpdXM6IHRoaXMuTGV2ZWwyUmFuZ2UodGhpcy5tYXAuZ2V0TGV2ZWwoKSksCiAgICAgICAgICBzdHJva2VXZWlnaHQ6IDMsIAogICAgICAgICAgc3Ryb2tlQ29sb3I6ICcjNzVCOEZBJywgCiAgICAgICAgICBzdHJva2VPcGFjaXR5OiAxLCAKICAgICAgICAgIHN0cm9rZVN0eWxlOiAnc29saWQnLCAKICAgICAgICAgIGZpbGxDb2xvcjogJyNDRkU3RkYnLCAKICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjEgIAogICAgICAgIH0pOwogICAgICBheGlvcy5nZXQoJ2h0dHBzOi8vOG9pOXMwbm50aC5hcGlndy5udHJ1c3MuY29tL2Nvcm9uYTE5LW1hc2tzL3YxL3N0b3Jlc0J5R2VvL2pzb24/bGF0PScrIGxhdCArJyZsbmc9JysgbG5nICsnJm09Jyt0aGlzLkxldmVsMlJhbmdlKHRoaXMubWFwLmdldExldmVsKCkpKSAKICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHZhciByZWRJbWFnZVNyYyA9IHJlcXVpcmUoJ0AvYXNzZXRzL3JlZG1hc2sucG5nJyksCiAgICAgICAgICAgICAgeWVsbG93SW1hZ2VTcmMgPSByZXF1aXJlKCdAL2Fzc2V0cy95ZWxsb3dtYXNrLnBuZycpLAogICAgICAgICAgICAgIGdyZWVuSW1hZ2VTcmMgPSByZXF1aXJlKCdAL2Fzc2V0cy9ncmVlbm1hc2sucG5nJyksCiAgICAgICAgICAgICAgZ3JleUltYWdlU3JjID0gcmVxdWlyZSgnQC9hc3NldHMvZ3JleW1hc2sucG5nJyksCiAgICAgICAgICAgICAgaW1hZ2VTaXplID0gbmV3IGtha2FvLm1hcHMuU2l6ZSgzMCwgNDApOwogICAgICAgICAgdmFyIHJlZE1hcmtlckltYWdlID0gbmV3IGtha2FvLm1hcHMuTWFya2VySW1hZ2UocmVkSW1hZ2VTcmMsaW1hZ2VTaXplLHt9KSwKICAgICAgICAgICAgICB5ZWxsb3dNYXJrZXJJbWFnZSA9IG5ldyBrYWthby5tYXBzLk1hcmtlckltYWdlKHllbGxvd0ltYWdlU3JjLGltYWdlU2l6ZSx7fSksCiAgICAgICAgICAgICAgZ3JlZW5NYXJrZXJJbWFnZSA9IG5ldyBrYWthby5tYXBzLk1hcmtlckltYWdlKGdyZWVuSW1hZ2VTcmMsaW1hZ2VTaXplLHt9KSwKICAgICAgICAgICAgICBncmV5TWFya2VySW1hZ2UgPSBuZXcga2FrYW8ubWFwcy5NYXJrZXJJbWFnZShncmV5SW1hZ2VTcmMsaW1hZ2VTaXplLHt9KTsKICAgICAgICAgIGlmKHRoaXMubWFya2VyQXJyYXkubGVuZ3RoKQogICAgICAgICAgICBmb3IodmFyIGk9MDtpPHRoaXMubWFya2VyQXJyYXkubGVuZ3RoO2krKykKICAgICAgICAgICAgICB0aGlzLm1hcmtlckFycmF5W2ldLnNldE1hcChudWxsKTsKICAgICAgICBmb3IodmFyIGk9MDtpPHJlcy5kYXRhLmNvdW50O2krKyl7CiAgICAgICAgICB2YXIgbWFya2VySW1hZ2UgPSBudWxsOwogICAgICAgICAgc3dpdGNoKHJlcy5kYXRhLnN0b3Jlc1tpXS5yZW1haW5fc3RhdCl7CiAgICAgICAgICAgIGNhc2UgJ3BsZW50eSc6CiAgICAgICAgICAgICAgbWFya2VySW1hZ2U9Z3JlZW5NYXJrZXJJbWFnZTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnc29tZSc6CiAgICAgICAgICAgICAgbWFya2VySW1hZ2U9eWVsbG93TWFya2VySW1hZ2U7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Zldyc6CiAgICAgICAgICAgICAgbWFya2VySW1hZ2U9cmVkTWFya2VySW1hZ2U7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgbWFya2VySW1hZ2U9Z3JleU1hcmtlckltYWdlOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHRoaXNNYXJrZXIgPSBuZXcga2FrYW8ubWFwcy5NYXJrZXIoeyAKICAgICAgICAgICAgcG9zaXRpb246IG5ldyBrYWthby5tYXBzLkxhdExuZyhyZXMuZGF0YS5zdG9yZXNbaV0ubGF0LHJlcy5kYXRhLnN0b3Jlc1tpXS5sbmcpLAogICAgICAgICAgICBpbWFnZTogbWFya2VySW1hZ2UKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5tYXJrZXJBcnJheS5wdXNoKHRoaXNNYXJrZXIpOwogICAgICAgICAgdGhpc01hcmtlci5zZXRNYXAodGhpcy5tYXApOwogICAgICAgIH0KICAgICAgfSkKICAgIH0sCgogIH0sCiAgY3JlYXRlZCgpIHsKICAgIC8vZG8gd2Ugc3VwcG9ydCBnZW9sb2NhdGlvbgogICAgaWYoISgiZ2VvbG9jYXRpb24iIGluIG5hdmlnYXRvcikpIHsKICAgICAgdGhpcy5lcnJvclN0ciA9ICdHZW9sb2NhdGlvbiBpcyBub3QgYXZhaWxhYmxlLic7CiAgICAgIGFsZXJ0KHRoaXMuZXJyb3JTdHIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5nZXR0aW5nTG9jYXRpb24gPSB0cnVlOwogICAgLy8gZ2V0IHBvc2l0aW9uCiAgICBuYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKHBvcyA9PiB7CiAgICAgIHRoaXMuZ2V0dGluZ0xvY2F0aW9uID0gZmFsc2U7CiAgICAgIHRoaXMubG9jYXRpb24gPSBwb3M7CiAgICAgIGlmKHRoaXMubWFwKSB7dGhpcy5zZXRDZW50ZXIoKTt9CiAgICB9LCBlcnIgPT4gewogICAgICB0aGlzLmdldHRpbmdMb2NhdGlvbiA9IGZhbHNlOwogICAgICB0aGlzLmVycm9yU3RyID0gZXJyLm1lc3NhZ2U7CiAgICB9KQogIH0sCgp9Cg=="},{"version":3,"sources":["Map.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"Map.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <vue-daum-map\n    :appKey=\"appKey\"\n    :center.sync=\"center\"\n    :level.sync=\"level\"\n    :mapTypeId=\"mapTypeId\"\n    :libraries=\"libraries\"\n    @load=\"onLoad\"\n    style=\"width:100%;height:100%\"/>\n    <!-- <v-btn @click=\"getStoresByGeo_Center\" elevation=\"10\" style=\"position:absolute;top:0;z-index:999;\">aa</v-btn> -->\n  </div>\n</template>\n\n<script type=\"text/javascript\" src=\"//dapi.kakao.com/v2/maps/sdk.js?appkey=6f428547f8ff26402d2ede8daa8b240c&libraries=clusterer\"></script>\n\n<script>\n  import VueDaumMap from 'vue-daum-map';\n  import axios from 'axios';\n  export default {\n    name: 'Map',\n\n    components:{\n      VueDaumMap,\n    },\n\n    data: () => ({\n      appKey: '6f428547f8ff26402d2ede8daa8b240c',\n      center: {lat:33.450701, lng:126.570667},\n      level: 4, \n      mapTypeId: VueDaumMap.MapTypeId.NORMAL, \n      libraries: [],\n      map: null,\n      centerMarker:null,\n      centerCircle:null,\n      markerArray:[],\n\n      location:null,\n      gettingLocation: false,\n      errorStr:null,\n    }),\n    methods: {\n      // 지도가 로드 완료되면 load 이벤트 발생\n      onLoad (map) {\n        this.map = map;\n        if(this.location){\n          this.setCenter();\n        }\n        var ref=this;\n        var startLat,startLng,startLevel;\n        kakao.maps.event.addListener(map, 'dragend', function() {\n          ref.getStoresByGeo(map.getCenter().getLat(),map.getCenter().getLng());\n        });\n        kakao.maps.event.addListener(map, 'zoom_start', function() {\n          startLat=map.getCenter().getLat();\n          startLng=map.getCenter().getLng();\n        });\n        kakao.maps.event.addListener(map, 'zoom_changed', function() {\n          if(map.getLevel()>startLevel)\n            map.setCenter(new kakao.maps.LatLng(startLat,startLng));\n          ref.getStoresByGeo(map.getCenter().getLat(),map.getCenter().getLng());\n        });\n      },\n      setCenter: function(){\n        if(this.centerMarker) this.centerMarker.setMap(null);\n        this.map.setLevel(4);\n        this.map.setCenter(new kakao.maps.LatLng(this.location.coords.latitude,this.location.coords.longitude));\n        var imageSrc = require('@/assets/person_pin_24px_red.svg'),  \n            imageSize = new kakao.maps.Size(36, 36);\n        var markerImage = new kakao.maps.MarkerImage(imageSrc,imageSize,{});\n        this.centerMarker = new kakao.maps.Marker({ \n          position: this.map.getCenter(),\n          image: markerImage\n        });\n        this.centerMarker.setMap(this.map);\n        this.getStoresByGeo(this.map.getCenter().getLat(),this.map.getCenter().getLng());\n      },\n      Level2Range: function(level){\n          if(level<5)\n            return 1500;\n          else if(level<8)\n            return 2500;\n          else if(level<10)\n            return 3500;\n          else return 5000;\n      },\n      getStoresByGeo: function(lat, lng){\n        if(this.centerCircle) this.centerCircle.setMap(null);\n          this.centerCircle = new kakao.maps.Circle({\n            map: this.map,\n            center : new kakao.maps.LatLng(lat,lng), \n            radius: this.Level2Range(this.map.getLevel()),\n            strokeWeight: 3, \n            strokeColor: '#75B8FA', \n            strokeOpacity: 1, \n            strokeStyle: 'solid', \n            fillColor: '#CFE7FF', \n            fillOpacity: 0.1  \n          });\n        axios.get('https://8oi9s0nnth.apigw.ntruss.com/corona19-masks/v1/storesByGeo/json?lat='+ lat +'&lng='+ lng +'&m='+this.Level2Range(this.map.getLevel())) \n        .then(res => {\n            var redImageSrc = require('@/assets/redmask.png'),\n                yellowImageSrc = require('@/assets/yellowmask.png'),\n                greenImageSrc = require('@/assets/greenmask.png'),\n                greyImageSrc = require('@/assets/greymask.png'),\n                imageSize = new kakao.maps.Size(30, 40);\n            var redMarkerImage = new kakao.maps.MarkerImage(redImageSrc,imageSize,{}),\n                yellowMarkerImage = new kakao.maps.MarkerImage(yellowImageSrc,imageSize,{}),\n                greenMarkerImage = new kakao.maps.MarkerImage(greenImageSrc,imageSize,{}),\n                greyMarkerImage = new kakao.maps.MarkerImage(greyImageSrc,imageSize,{});\n            if(this.markerArray.length)\n              for(var i=0;i<this.markerArray.length;i++)\n                this.markerArray[i].setMap(null);\n          for(var i=0;i<res.data.count;i++){\n            var markerImage = null;\n            switch(res.data.stores[i].remain_stat){\n              case 'plenty':\n                markerImage=greenMarkerImage;\n                break;\n              case 'some':\n                markerImage=yellowMarkerImage;\n                break;\n              case 'few':\n                markerImage=redMarkerImage;\n                break;\n              default:\n                markerImage=greyMarkerImage;\n            }\n            var thisMarker = new kakao.maps.Marker({ \n              position: new kakao.maps.LatLng(res.data.stores[i].lat,res.data.stores[i].lng),\n              image: markerImage\n            });\n            this.markerArray.push(thisMarker);\n            thisMarker.setMap(this.map);\n          }\n        })\n      },\n\n    },\n    created() {\n      //do we support geolocation\n      if(!(\"geolocation\" in navigator)) {\n        this.errorStr = 'Geolocation is not available.';\n        alert(this.errorStr);\n        return;\n      }\n\n      this.gettingLocation = true;\n      // get position\n      navigator.geolocation.getCurrentPosition(pos => {\n        this.gettingLocation = false;\n        this.location = pos;\n        if(this.map) {this.setCenter();}\n      }, err => {\n        this.gettingLocation = false;\n        this.errorStr = err.message;\n      })\n    },\n\n  }\n</script>\n"]}]}